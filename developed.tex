I developed two extensions to leverage 
the capabilities of Cyclus to model
real-world fuel cycle transition scenarios.
The first extension is a python input-generating module
that allows automated scenario generation of the real-world 
nuclear fleet at any point in time. The second extension
is a Cyclus archetype that mimics \gls{MSR} feed and removal
behavior using a HDF5 database generated from SaltProc.

\section{write\_input.py}
The objective for the \texttt{write\_input.py} module
is to automate the population of Cyclus input files
to model the state of reactor fleets at a given
point in time. 

The module reads from the \gls{PRIS} database
and extracts data on each reactor's country, reactor unit,
type, net capacity (MWe), status, operator, construction date,
first criticality date, first grid date, commercial date,
and shutdown date (if applicable). The user inputs simulation
configurations such as start year, start month, and
simulation duration. The module uses the collected data to
fill out a template into a Cyclus input file. The logic flow of the module is 
shown in diagram \ref{diag:log_flow}


\begin{figure}
	\centering
	\begin{tikzpicture}[node distance=3.5cm and 2cm, on grid, auto, text width=2cm]
	\node (database) [object] {PRIS Database (\texttt{.csv})};
	\node (data) [process, below of=database] {Reactor data (net capacity, reactor size)};
	
	\node (user) [object, right of=database] {User};
	\node (input) [process, below of=user] {Start year, month,  Simulation duration};
	
	\node (template) [process, right of=user] {Cyclus input template files};
	
	\node (script) [object, below of=input] {write\_input.py};
	
	\node (lifetime) [process, below of=script] {Calculated reactor lifetime};
	\node (coresize) [process, right of=lifetime] {Interpolated core size};
	\node (region) [process, left of=lifetime] {Calculated deployment scheme};
	
	\node (output) [object, below of=lifetime] {Generated Cyclue Input File (.xml)};
	
	\draw [arrow] (database) -- (data); 
	\draw [arrow] (user) -- (input); 
	\draw [arrow] (data) -- (script);
	\draw [arrow] (input) -- (script);
	\draw [arrow] (template) -- (script);
	
	\draw [arrow] (script) -- (lifetime);
	\draw [arrow] (script) -- (coresize);
	\draw [arrow] (script) -- (region);
	
	\draw [arrow] (lifetime) -- (output);
	\draw [arrow] (coresize) -- (output);
	\draw [arrow] (region) -- (output);
	
	\end{tikzpicture}
	\caption{ Logic flow of \texttt{write\_input.py}.
		Green circles and blue boxes represent files and data, respectively.}
	\label{diag:log_flow}
\end{figure}

\subsection{Assumptions}
The module calculates the deployment
scheme of the reactors and their lifetimes by assuming
that all reactors shut down after 60 years of operation.
If the expected shutdown date is later than the user-input
simulation start date,
the reactor is not written in the input. If the reactor was
operational before the simulation start date, the reactor
is deployed at the beginning of simulation with its remaining lifetime.
If the reactor is reactor's start date is later than the simulation
start date, and the shutdown time is undefined, the reactor
is deployed at the defined start date with 60 years of lifetime.

The module calculates the core sizes of various reactor
types by using a linear core size model. It assumes that
reactor cores scale linearly from a model reactor design.
The model reactor designs are listed in table \ref{tab:lin_core}.

\begin{table}[h]
	\centering
	\caption{Reactor model designs used for the linear core size model.}
	\begin{tabularx}{\textwidth}{bsssss}
		\hline
		\textbf{Category} & \textbf{Model Reactor} & \textbf{Power [MWe]} & \textbf{Assembly Mass [kg]} & \textbf{Assemblies in Core} & \textbf{Reference}  \\
		\hline
		Generic \gls{PWR} & AP-1000 & 1117 & 446 & 157 & \cite{schulz_westinghouse_2006} \\
		Generic \gls{BWR} & 4-MK I & 1098 &180 & 764 & \cite{moore_physical_1989} \\
		Generic \gls{PHWR} & CANDU6 & 700 & 24.17 & 4,560 & \cite{galeriu_technical_nodate} \\
		\hline
	\end{tabularx}
	\label{tab:lin_core}
\end {table}



\section{HDF5-reactor}
The HDF5 reactor is a Cyclus facility archetype designed to 
model \gls{MSR} behavior. It roughly couples Saltproc \cite{rykhlevskii_online_2017}
and Cyclus, by using the output from SaltProc to mimic \gls{MSR}
feed and removal behavior in Cyclus. Most of the computationally heavy
work is done in SERPENT (driven  by Saltproc) in generation of the database, which avoids the large computational burden
when running Cyclus. This method is similar to the simplified implementation of
recipe reactors, where the depletion calculation is performed outside of the
fuel cycle simulation. This reactor uses a database of recipes
rather than a single recipe in order to capture the continuously varying
nature of liquid-fueled reactors like \glspl{MSR}. Since there is no
defined burnup step, the database includes all stream isotopics 

\begin{figure}
	\centering
	\begin{tikzpicture}[node distance=3.5cm and 2cm, on grid, auto, text width=2cm]
	
	\node (msr) [object] {\gls{MSR} design};
	\node (repro) [object, right of = msr] {Reprocessing Scheme};
	\node (timesteps) [object, right of = repro] {Timesteps};
	
	\node (saltproc) [process, below of = repro] {Saltproc};
	\node (serpent) [process, right of = saltproc] {SERPENT 2};
	
	\node (hdf5) [object, below of = saltproc] {HDF5 Database};
	
	\node (hdf5 reactor) [process, below of = hdf5] {HDF5-reactor};
	
	\node (bid) [object, below of = hdf5 reactor] {Feed Material bid};
	\node (request) [object, right of = bid] {Waste Material request};
	\node (power) [object, left of = bid] {Power};
	
	\node (cyclus) [process, below of = bid] {Cyclus};


	\draw [arrow] (msr) -- (saltproc); 
	\draw [arrow] (repro) -- (saltproc); 
	\draw [arrow] (timesteps) -- (saltproc);
	
	\draw [arrow] (saltproc) -- (serpent);
	\draw [arrow] (serpent) -- (saltproc);
		
	\draw [arrow] (saltproc) -- (hdf5);
	\draw [arrow] (hdf5) -- (hdf5 reactor);
	
	\draw [arrow] (hdf5 reactor) -- (bid);
	\draw [arrow] (hdf5 reactor) -- (request);
	\draw [arrow] (hdf5 reactor) -- (power);
	
	\draw [arrow] (bid) -- (cyclus);
	\draw [arrow] (request) -- (cyclus);
	\draw [arrow] (power) -- (cyclus);
	
	
	\end{tikzpicture}
	\caption{ Logic flow of \texttt{HDF5 Reactor}.
		Green circles and blue boxes represent files and data, respectively.}
	\label{diag:hdf5_flow}
\end{figure}

\subsection{Code Description}
The user inputs only of the commodity names
for each stream, and the database path, since the
HDF5 database already contains the notion of reactor design,
reprocessing scheme, and other reactor parameters (shown in
figure \ref{diag:hdf5_flow}). The commodity names are needed
for reactor agent to communicate with other Cyclus agents
in exchanging material.

At every timestep, 
The \texttt{HDF5 Reactor} calculates the cumulative material
